# 0320作业——Cache命中率
Q：

考虑一个4行且每行16字节的cache，主存按每块16字节划分，即块0有地址0到15的16个字节，等等。现在考虑一个程序，它以如下地址顺序访问主存：

一次：63 ~ 70

循环10次：15 ~ 32，80 ~ 95

（a）假设cache采用直接映射技术。主存块0, 4, ... 指派到行0；块1，5， ... 指派到行1；以此类推。请计算命中率。

（b）假设cache采用二路组关联映射，共有两组，每组两行。偶序号块被指派到组0，奇序号块被指派到组1。请计算使用LRU替换策略的二路组关联cache的命中率。 

**Answer：**
1. 直接映射：
   - 63 Miss，将主存的第$3$块读进Cache的第$3$行
   - 64 Miss，将主存的第$0$块读进Cache的第$0$行
   - 65-70 hit。
   - 15 Miss, 将主存的第$0$块读进Cache的第$0$行
   - 16 Miss, 将主存的第$1$块读进Cache的第$1$行
   - 17-31 hit
   - 32 Miss，将主存的第$2$块读进Cache第$2$行
   - 80 Miss，将主存的第$5$块读进Cache的第$1$行
   - 81-95 hit
  
  **以下循环$9$次**
   - 15 hit
   - 16 Miss
   - 17-31 hit
   - 32 hit
   - 80 Miss
   - 81-95 hit
  ---
  总共Miss $6+2*9=24$次，总共hit $36+32*9=324$次，cache命中率$\frac{324}{324+24}=0.931.$

2. 组关联映射:
   - 63 Miss, 将主存第$3$块读进Cache第$1$组第$0$行
   - 64 Miss, 将主存第$4$块读进Cache第$0$组第$0$行
   - 65-70 Hit
   - 15 Miss, 将主存第$0$块读进Cache第$0$组第$1$行
   - 16 Miss, 将主存第$1$块读进Cache第$1$组第$1$行
   - 17-31 hit,
   - 32 Miss, 将主存第$2$块读进Cache第$0$组第$0$行
   - 80 Miss, 将主存的第$5$块读进Cache第$1$组第$0$行
   - 81-95 hit,

    **以下循环$9$次**
    - 15 hit
    - 16-31 hit
    - 32 hit
    - 80-95hit

---
总共Miss $6$次，总共hit $36+34*9=342$次，Cache命中率$\frac{342}{342+6}=0.983$
   
  

